Описание проекта

Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.
Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком. 
Постройте модель с предельно большим значением F1-меры. Чтобы сдать проект успешно, нужно довести метрику до 0.59. Проверьте F1-меру на тестовой выборке самостоятельно.
Дополнительно измеряйте AUC-ROC, сравнивайте её значение с F1-мерой.

Описание данных

Признаки

RowNumber — индекс строки в данных
CustomerId — уникальный идентификатор клиента
Surname — фамилия
CreditScore — кредитный рейтинг
Geography — страна проживания
Gender — пол
Age — возраст
Tenure — сколько лет человек является клиентом банка
Balance — баланс на счёте
NumOfProducts — количество продуктов банка, используемых клиентом
HasCrCard — наличие кредитной карты
IsActiveMember — активность клиента
EstimatedSalary — предполагаемая зарплата

Целевой признак

Exited — факт ухода клиента

Краткие выводы по проекту: 
    
В ходе выполнения проекта ислледованы данные клиентов банка "Бета-Банк". Предобработаны данные в датасете, изучены основные признаки клиентов: страна проживания, пол, возраст, срок обслуживания, количество используемых продкутов банка, наличие кредитной карты, активность клиента, баланс на счетах клиентов и предполагаемая зарплата. Выявлены неявные закономерности ушедших клиентов (наличие 3 и 4 продуктов банка, пассивность клиентов).
Исторические данные разбиты на 3 части - тренировочная, валидационная и тестовая в соотношении 3:1:1. Проведена стандартизация признаков. Построены модели логистической регрессии, дерева решений и случайного леса. Подобраны гиперпараметры для моделей без учета дисбаланса, с лучшим результатом F1-меры равной 0,591. 
Выявлен дисбаланс классов. Применены три методики устранения проблемы:
- задание веса классов;
- upsampling;
- downsampling.


Для каждого метода подобраны модели с гиперпараметрами, имеющими наилучшие результаты метрик F1 и ROC-AUC. К каждой модели написаны промежуточные результаты и по каждой методике написаны выводы.
Параллельно с этим подсчитана метрика ROC-AUC. Для финального тестирования выбрана модели случайного леса показавшая лучшие результаты по F1 и ROC-AUC метрикам в предыдущих исследованиях.
Для финального тестирования объеденины тренировочная и валидационная выборка. Спрогнозированы факт ухода клиента на тестовой выборке с результатами:
- F1-мера модели: 0.601, что хуже сбалансированной модели;
- AUC-ROC модели: 0.861.

Результаты превосходят значения, полученные при первой сдаче проекта. На основе матрицы спутанности можно сделать вывод, что модель истинно положительно отвечает в 70% случаях и истинно отрицательно в 86%.

Наилучший метод борьбы с дизбалансом - присваивание веса классов в агрументах модели. Метрики всех обученных моделей представлены ниже:

Несбалансированные классы

        Логистическая регрессия Дерево решений Случайный лес
F1                        0.336          0.591         0.577
ROC-AUC                    0.76          0.809         0.858

Добавление весов классов

        Логистическая регрессия Дерево решений Случайный лес
F1                        0.493           0.57         0.633
ROC-AUC                   0.763          0.833         0.858

Преобразование upsampling

        Логистическая регрессия Дерево решений Случайный лес
F1                        0.497           0.57         0.629
ROC-AUC                   0.763          0.833         0.855

Преобразование downsampling

        Логистическая регрессия Дерево решений Случайный лес
F1                        0.501           0.57         0.629
ROC-AUC                   0.764          0.833         0.855

Тестовая модель

        Логистическая регрессия Дерево решений Случайный лес
F1                            -              -         0.601
ROC-AUC                       -              -         0.861